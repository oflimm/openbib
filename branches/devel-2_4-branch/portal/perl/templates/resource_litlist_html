[%#-
#######################################################################
#
# Templatename: resource_litlist_html
#
# Typ         : Mastertemplate
#
# Aufgabe:
#
# Ausgabe einer bestehenden Literaturlisten
#
#######################################################################
-%]
[% PROCESS common/subtemplate name="std_header" disable_cache_control=1 %]

  <body>

[% PROCESS common/subtemplate name="corporate_banner" %] 

[% PROCESS common/subtemplate name="mainnavigation" %] 
[% PROCESS common/subtemplate name="visible_categories_title" %]

<div id="maincontent">

<ul class="tabbingmenu">
   <li><a class="active" href="[% config.get('base_loc') %]/[% view %]/[% config.get('handler').resource_litlist_loc.name %]/[% litlist.properties.id %]/">[% msg.maketext("Literaturliste") %]</a></li>
</ul>

<div class="content">

<p />

[%# USE dumper; dumper.dump(litlist)%]
[% IF litlist.recordlist.size > 0 %]

<!-- Titlelist begins here -->
<div class="resultlist">
  <div class="resultheader">
    <div class="catalogue">
[% litlist.properties.title %][%- IF litlist.properties.lecture -%]&nbsp;<img src="[% config.get('university_img') %]" title="[% msg.maketext("Offizielle Literaturliste des Instituts/Seminars") %]" alt="[% msg.maketext("Offizielle Literaturliste des Instituts/Seminars") %]" style="vertical-align:bottom"/>[%- END -%]
    </div>
    <div class="hits">
[% litlist.recordlist.get_size %] [% msg.maketext("Titel") %]
    </div>
    <div class="navigation">
<b>[% msg.maketext("Themengebiete") %]</b>:&nbsp;
[%- IF litlist.properties.subjects.size -%]
[%- FOREACH subject IN litlist.properties.subjects-%]
<a href="[% config.get('base_loc') %]/[% view %]/[% config.get('handler').info_loc.name %]/54?id=[% subject.id %]">[% subject.name %]</a>&nbsp;&nbsp;
[%- END-%]
[%- ELSE -%]
[% msg.maketext("Keine") %]
[%- END-%]
    </div>
  </div>
[%- IF format == 'HTML' && show == 'short' -%]
  <div class="listoptions">
<!-- Titlelist begins here -->
<form method="get" action="[% config.get('base_loc') %]/[% view %]/[% config.get('handler').resource_litlist_loc.name %]/[% litlist.properties.id %]/">

<input type="hidden" name="sortall"         value="1" />

[% PROCESS common/subtemplate name="titlist_options" this_loc=config.get('resource_litlist_loc') %]

</form>
  </div>
[%- END -%]
  <div class="rightoptions">
[% IF NOT hide_options %]
<div class="reuse_data"><!-- Begin Reuse -->

<b>[% msg.maketext("Behalten Sie diese Liste") %]:</b><p/>

<table>
<tr>
<th><img src="[% config.get('permalink_img') %]" alt="[% msg.maketext("Als Permanenten Link verwenden") %]" border="0" /></th>
<td><a href="http://[% config.get('loadbalancerservername') %][% config.get('base_loc') %]/[% view %]/[% config.get('handler').connector_permalink_loc.name %]/[% litlist.properties.userid %]/[% litlist.id %]/6/[%- IF view -%][% view %]/[%- END -%]index.html" target="_blank" title="[% msg.maketext("Permanenter Link") %]">[% msg.maketext("Permanenter Link") %]</a></td>
</tr>
</table>

<p />

<div class="headline">[% msg.maketext("Andere Formate") %]</div>

<p>
<a href="[% config.get('base_loc') %]/[% view %]/[% config.get('handler').resource_litlist_loc.name %]/[% litlist.id %]/html?show=short" [%- IF show == 'short' && format == 'HTML'-%]class="selected_item"[%- END -%]>[% msg.maketext("Kurztitel") %]</a>, <a href="[% config.get('base_loc') %]/[% view %]/[% config.get('handler').resource_litlist_loc.name %]/[% litlist.id %]/html?show=full" [%- IF show == 'full' && format == 'HTML'-%]class="selected_item"[%- END -%]>[% msg.maketext("Volltitel") %]</a>, <a href="[% config.get('base_loc') %]/[% view %]/[% config.get('handler').resource_litlist_loc.name %]/[% litlist.id %]/?format=Text;show=full" [%- IF format == 'Text'-%]class="selected_item"[%- END -%]>Text</a>, <a href="[% config.get('base_loc') %]/[% view %]/[% config.get('handler').resource_litlist_loc.name %]/[% litlist.id %]/?format=BibTeX;show=full" [%- IF format == 'BibTeX'-%]class="selected_item"[%- END -%]>BibTeX</a>, <a href="[% config.get('base_loc') %]/[% view %]/[% config.get('handler').resource_litlist_loc.name %]/[% litlist.id %]/?format=EndNote;show=full" [%- IF format == 'EndNote'-%]class="selected_item"[%- END -%]>EndNote</a> 
</p>
</div>

[% IF user_owns_litlist %]
<form method="get" action="[% config.get('base_loc') %]/[% view %]/[% config.get('handler').resource_litlist_loc.name %]/[% litlist.properties.id %]/">
<input type="hidden" name="action"     value="manage" />

[%# USE dumper;dumper.dump(litlist)%]
<table width="100%">
<tr><th>[% msg.maketext("Einstellungen &auml;ndern") %]</th></tr>
<tr><td class="boxedclear" style="font-size:0.9em">
<table>
<tr>
<td><b>[% msg.maketext("Titel der Liste") %]</b></td><td><input type="text" name="title" value="[% litlist.properties.title %]" size="20"/></td></tr>
</tr>
<tr>
<td><b>[% msg.maketext("Sichtbarkeit") %]</b></td><td><select name="type"><option value="1" [% IF litlist.properties.type == 1%] selected="selected"[% END %]>[% msg.maketext("&ouml;ffentlich") %]</option><option value="2"[% IF litlist.properties.type == 2 %] selected="selected"[% END %]>[% msg.maketext("privat") %]</option></select></td></tr>
</tr>
<tr>
[%- IF userrole.${"librarian"} || userrole.${"lecturer"} -%]<td><b>[% msg.maketext("Offiziell") %]</b></td><td><select name="lecture"><option value="1" [% IF litlist.properties.lecture == 1%] selected="selected"[% END %]>[% msg.maketext("Ja") %]</option><option value="0"[% IF litlist.properties.lecture == 0 %] selected="selected"[% END %]>[% msg.maketext("Nein") %]</option></select></td>[%- END -%]
</tr>

<tr><td colspan="2">&nbsp;</td></tr>

<tr><td colspan="2">Ordnen Sie Ihre Literaturliste thematisch ein</td></tr>
<tr><td colspan="2">
<select name="subjectids" multiple="multiple" size="5">

[% FOREACH subject IN subjects %]
<option value="[% subject.id %]" [% IF litlist.properties.subject_selected.${subject.id} %] selected="selected"[% END %]>[% subject.name | truncate(40) %]</option>
[% END %]

</select>
</td></tr>

<tr>
<td colspan="2"><div class="cssbutton glass kug"><input type="submit" name="do_changelist" value="[% msg.maketext("&Auml;ndern") %]" /></div></td></tr>
</tr>

</table>
</td></tr>
</table>

</form>

[% END %]

</div>
[% END %]
  <div class="resultitems [% IF qopts.listtype == 'list' %] liststyle[%- END -%]">

[% IF format == 'Text' %]

[% PROCESS common/subtemplate name="resource_litlist_html_as_text" %]

[% ELSIF format == 'BibTeX' %]

[% PROCESS common/subtemplate name="resource_litlist_html_as_bibtex" %]

[% ELSIF format == 'EndNote' %]

[% PROCESS common/subtemplate name="resource_litlist_html_as_endnote" %]

[% ELSIF show == 'short' %]

[% PROCESS common/subtemplate name="resource_litlist_html_short" %]

[% ELSIF show == 'full' %]

[% PROCESS common/subtemplate name="resource_litlist_html_full" %]

[%- END # Ende Endnote/Alles -%]

</div>
<!-- Resultitems ends here -->

</div>
<!-- Titlelist ends here -->

[%# USE dumper;dumper.dump(other_litlists)%]

[% IF other_litlists.same_user.size > 0 || other_litlists.same_title.size > 0%] 
<p />

<div id="additional_title_info">
<ul>
[% IF other_litlists.same_user.size > 0 %]
<li><a href="#same_user"><span>[% msg.maketext("Andere Listen dieses Nutzers") %]</span></a></li>
[% END %]

[% IF other_litlists.same_title.size > 0 %]
<li><a href="#same_title"><span>[% msg.maketext("Listen mit gemeinsamen Titeln") %]</span></a></li>
[% END %]
</ul>

[% IF other_litlists.same_user.size > 0%] 

<h2 class="nojs_show">[% msg.maketext("Andere Listen dieses Nutzer") %]</h2>

<div id="same_user">
<!-- Begin: Gleicher Nutzer -->

<table>
[% listrow = 'listrow1' %]
[% FOREACH other_litlist IN other_litlists.same_user %]
[%   IF other_litlist.type == 1 %]
<tr class="[% listrow %]"><td><a href="http://[% config.get('servername') %][% config.get('base_loc') %]/[% view %]/[% config.get('handler').resource_litlist_loc.name %]/[% other_litlist.id %]/"><b>[% other_litlist.title %]</b></a>&nbsp([% other_litlist.itemcount %] Titel)[%- IF litlist.properties.lecture -%]&nbsp;<img src="[% config.get('university_img') %]" title="[% msg.maketext("Offizielle Literaturliste des Instituts/Seminars") %]" alt="[% msg.maketext("Offizielle Literaturliste des Instituts/Seminars") %]" style="vertical-align:bottom"/>[%- END -%]</td><td align="center"><a href="http://[% config.get('loadbalancerservername') %][% config.get('base_loc') %]/[% view %]/[% config.get('handler').connector_permalink_loc.name %]/[% other_litlist.userid %]/[% other_litlist.id %]/6/[%- IF view -%][% view %]/[%- END -%]index.html" target="_blank" title="Permanenter Link"><img src="[% config.get('permalink_img') %]" alt="[% msg.maketext("Als Permanenten Link verwenden") %]" border="0" /></a></td></tr>

[%     IF listrow == 'listrow1' %]
[%       listrow = 'listrow2' %]
[%     ELSE %]
[%       listrow = 'listrow1' %]
[%     END %]
[%   END %]
[% END %]

</table>

<!-- Ende: Gleicher Nutzer -->
</div>
[% END %]

[% IF other_litlists.same_title.size > 0%] 

<h2 class="nojs_show">[% msg.maketext("Listen mit gemeinsamen Titeln") %]</h2>

<div id="same_title">
<!-- Begin: Gleicher Nutzer -->

<table>
[% listrow = 'listrow1' %]
[% FOREACH other_litlist IN other_litlists.same_title %]
[%   IF other_litlist.type == 1 %]
<tr class="[% listrow %]"><td><a href="[% config.get('base_loc') %]/[% view %]/[% config.get('handler').resource_litlist_loc.name %]/[% other_litlist.id %]/"><b>[% other_litlist.title %]</b></a>&nbsp([% other_litlist.itemcount %] Titel)&nbsp;[%- IF other_litlist.lecture -%]&nbsp;<img src="[% config.get('university_img') %]" title="[% msg.maketext("Offizielle Literaturliste des Instituts/Seminars") %]" alt="[% msg.maketext("Offizielle Literaturliste des Instituts/Seminars") %]" style="vertical-align:bottom"/>[%- END -%]</td><td align="center"><a href="http://[% config.get('loadbalancerservername') %][% config.get('base_loc') %]/[% view %]/[% config.get('handler').connector_permalink_loc.name %]/[% other_litlist.userid %]/[% other_litlist.id %]/6/[%- IF view -%][% view %]/[%- END -%]index.html" target="_blank" title="Permanenter Link"><img src="[% config.get('permalink_img') %]" alt="[% msg.maketext("Als Permanenten Link verwenden") %]" border="0" /></a></td></tr>

[%     IF listrow == 'listrow1' %]
[%       listrow = 'listrow2' %]
[%     ELSE %]
[%       listrow = 'listrow1' %]
[%     END %]
[%   END %]
[% END %]

</table>

<!-- Ende: Gleicher Nutzer -->
</div>
[% END %]

[% END %]

[% END %]

</div>

</div>

[% PROCESS common/subtemplate name="std_footer" %]
