[%-

all_viewinfo = [] ;
FOREACH viewinfo IN views.all ;

  databases = [];
  FOREACH item IN config.get_viewdbs(viewinfo.viewname).sort ;
    databases.push({ dbname = item, description = dbinfo.dbnames.${item}.full });
  END ;

  this_viewinfo = {
    description = viewinfo.description
    active      = viewinfo.active
    profile     = { id = viewinfo.profileid.id, description = viewinfo.profileid.description },
    databases   = databases,
  };
  
  all_viewinfo.push(this_viewinfo);
END;

to_json(all_viewinfo) ;

-%]